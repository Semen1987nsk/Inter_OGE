# üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã —Å–∂–∞—Ç–∏—è –ø—Ä—É–∂–∏–Ω—ã

**–î–∞—Ç–∞:** 20 –æ–∫—Ç—è–±—Ä—è 2025  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä—É–∂–∏–Ω–∞ –°–ñ–ò–ú–ê–ï–¢–°–Ø –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≥—Ä—É–∑–æ–≤ –≤–º–µ—Å—Ç–æ –†–ê–°–¢–Ø–ñ–ï–ù–ò–Ø  
**–°—Ç–∞—Ç—É—Å:** –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

---

## üêõ –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–ù–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞—Ö –≤–∏–¥–Ω–æ:
- **1 –≥—Ä—É–∑ (100–≥)** ‚Üí –ø—Ä—É–∂–∏–Ω–∞ –î–õ–ò–ù–ù–ê–Ø
- **2 –≥—Ä—É–∑–∞ (200–≥)** ‚Üí –ø—Ä—É–∂–∏–Ω–∞ –ö–û–†–û–ß–ï
- **3 –≥—Ä—É–∑–∞ (300–≥)** ‚Üí –ø—Ä—É–∂–∏–Ω–∞ –ï–©–Å –ö–û–†–û–ß–ï

**–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:** –ü—Ä—É–∂–∏–Ω–∞ –¥–æ–ª–∂–Ω–∞ –†–ê–°–¢–Ø–ì–ò–í–ê–¢–¨–°–Ø (—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –¥–ª–∏–Ω–Ω–µ–µ) –ø—Ä–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ –Ω–∞–≥—Ä—É–∑–∫–∏!

---

## üîç –ì–∏–ø–æ—Ç–µ–∑—ã

### –ì–∏–ø–æ—Ç–µ–∑–∞ 1: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ —Ä–∞—Å—Ç—è–∂–µ–Ω–∏—è
**–ü—Ä–æ–≤–µ—Ä–∫–∞:** –§–æ—Ä–º—É–ª–∞ `targetLength = springNaturalLength + elongationPx`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –§–æ—Ä–º—É–ª–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è (+, –∞ –Ω–µ -)

### –ì–∏–ø–æ—Ç–µ–∑–∞ 2: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π springConstant
**–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ú–æ–∂–µ—Ç –ø—Ä—É–∂–∏–Ω–Ω–∞—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è?  
**–°—Ç–∞—Ç—É—Å:** ‚è≥ –ü—Ä–æ–≤–µ—Ä–∏–º –≤ –ª–æ–≥–∞—Ö

### –ì–∏–ø–æ—Ç–µ–∑–∞ 3: updateVisualScale —Å–∂–∏–º–∞–µ—Ç –ø—Ä—É–∂–∏–Ω—É
**–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ú–æ–∂–µ—Ç `visual.scale` —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è —Å–ª–∏—à–∫–æ–º —Å–∏–ª—å–Ω–æ?  
**–°—Ç–∞—Ç—É—Å:** ‚è≥ –ü—Ä–æ–≤–µ—Ä–∏–º –≤ –ª–æ–≥–∞—Ö

### –ì–∏–ø–æ—Ç–µ–∑–∞ 4: stackHeight —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –∏ "—Å—ä–µ–¥–∞–µ—Ç" –º–µ—Å—Ç–æ
**–ü–æ–¥–æ–∑—Ä–µ–Ω–∏–µ:** `stackHeight` —Ä–∞—Å—Ç—ë—Ç —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –≥—Ä—É–∑–æ–≤  
**–ö–æ–¥:**
```javascript
const stackHeight = this.estimateWeightStackHeight();
const available = canvas.height - anchorY - stackHeight - marginBottom;
```
**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–≥–¥–∞ gruz–æ–≤ –±–æ–ª—å—à–µ ‚Üí stackHeight –±–æ–ª—å—à–µ ‚Üí available –º–µ–Ω—å—à–µ ‚Üí scale –º–µ–Ω—å—à–µ ‚Üí –ø—Ä—É–∂–∏–Ω–∞ –≤–∏–∑—É–∞–ª—å–Ω–æ –∫–æ—Ä–æ—á–µ!

**–°—Ç–∞—Ç—É—Å:** üî¥ –í–ï–†–û–Ø–¢–ù–ê–Ø –ü–†–ò–ß–ò–ù–ê!

---

## üìä –î–æ–±–∞–≤–ª–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –†–∞—Å—á—ë—Ç —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –¥–ª–∏–Ω—ã (attachWeight)
```
[SPRING MODE] üìè –†–∞—Å—á—ë—Ç —É–¥–ª–∏–Ω–µ–Ω–∏—è:
  - totalMass: XXX–≥
  - force: X.XXX–Ω
  - elongationPx: XXX.Xpx
  - springNaturalLength: 140px
  
[ATTACH-WEIGHT] üéØ –¶–µ–ª–µ–≤–∞—è –¥–ª–∏–Ω–∞ –ø—Ä—É–∂–∏–Ω—ã:
  - natural: 140px
  - elongation: XXX.Xpx
  - target: XXX.Xpx
  - shouldBeGreater: ‚úÖ/‚ùå
```

### 2. –í–∏–∑—É–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ (updateVisualScale)
```
[VISUAL-SCALE] üìê –†–∞—Å—á—ë—Ç –º–∞—Å—à—Ç–∞–±–∞:
  - requiredLength: XXX.Xpx (—Ñ–∏–∑–∏—á–µ—Å–∫–∞—è –¥–ª–∏–Ω–∞)
  - stackHeight: XXX.Xpx (–≤—ã—Å–æ—Ç–∞ —Å—Ç–æ–ø–∫–∏ –≥—Ä—É–∑–æ–≤)
  - available: XXX.Xpx (–º–µ—Å—Ç–æ –¥–ª—è –ø—Ä—É–∂–∏–Ω—ã)
  - needsScaling: true/false
  
[VISUAL-SCALE] üìâ Scaling down:
  - proposed: 0.XXX
  - finalScale: 0.XXX
  - visualLength: XXX.Xpx (–∏—Ç–æ–≥–æ–≤–∞—è –≤–∏–∑—É–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞)
```

---

## üß™ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –®–∞–≥ 1: –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É
- **F5**

### –®–∞–≥ 2: –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å
- **F12** ‚Üí Console
- **–û—á–∏—Å—Ç–∏—Ç–µ** –∫–æ–Ω—Å–æ–ª—å (Ctrl+L)

### –®–∞–≥ 3: –ü–æ–¥–≤–µ—Å—å—Ç–µ –û–î–ò–ù –≥—Ä—É–∑
- –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –≥—Ä—É–∑ 100–≥ –∫ –ø—Ä—É–∂–∏–Ω–µ
- **–°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç –∫–æ–Ω—Å–æ–ª–∏**
- –ó–∞–ø–∏—à–∏—Ç–µ –¥–ª–∏–Ω—É –ø—Ä—É–∂–∏–Ω—ã –Ω–∞ —ç–∫—Ä–∞–Ω–µ (–ø—Ä–∏–º–µ—Ä–Ω–æ)

### –®–∞–≥ 4: –ü–æ–¥–≤–µ—Å—å—Ç–µ –í–¢–û–†–û–ô –≥—Ä—É–∑
- –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –µ—â—ë –æ–¥–∏–Ω –≥—Ä—É–∑ 100–≥
- **–°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç –∫–æ–Ω—Å–æ–ª–∏**
- –°—Ä–∞–≤–Ω–∏—Ç–µ –¥–ª–∏–Ω—É –ø—Ä—É–∂–∏–Ω—ã

### –®–∞–≥ 5: –ü–æ–¥–≤–µ—Å—å—Ç–µ –¢–†–ï–¢–ò–ô –≥—Ä—É–∑
- –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ç—Ä–µ—Ç–∏–π –≥—Ä—É–∑ 100–≥
- **–°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç –∫–æ–Ω—Å–æ–ª–∏**
- –°—Ä–∞–≤–Ω–∏—Ç–µ –¥–ª–∏–Ω—É –ø—Ä—É–∂–∏–Ω—ã

---

## üìä –ß—Ç–æ –∏—Å–∫–∞—Ç—å –≤ –ª–æ–≥–∞—Ö

### –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Ñ–∏–∑–∏–∫–µ:

```
[SPRING MODE] üìè –†–∞—Å—á—ë—Ç —É–¥–ª–∏–Ω–µ–Ω–∏—è:
  elongationPx: -XXX.X  ‚Üê ‚ùå –û–¢–†–ò–¶–ê–¢–ï–õ–¨–ù–û–ï! (—Å–∂–∞—Ç–∏–µ –≤–º–µ—Å—Ç–æ —Ä–∞—Å—Ç—è–∂–µ–Ω–∏—è)
```

### –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –≤ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–∏:

```
–ì—Ä—É–∑ 1:
[VISUAL-SCALE] finalScale: 1.000  ‚Üê OK
[VISUAL-SCALE] visualLength: 180.0px

–ì—Ä—É–∑ 2:
[VISUAL-SCALE] stackHeight: 200.0px  ‚Üê ‚ö†Ô∏è –£–≤–µ–ª–∏—á–∏–ª–æ—Å—å!
[VISUAL-SCALE] available: 300.0px  ‚Üê ‚ö†Ô∏è –£–º–µ–Ω—å—à–∏–ª–æ—Å—å!
[VISUAL-SCALE] finalScale: 0.700  ‚Üê üìâ –°–∂–∞—Ç–∏–µ!
[VISUAL-SCALE] visualLength: 154.0px  ‚Üê –ö–û–†–û–ß–ï —á–µ–º –±—ã–ª–æ!

–ì—Ä—É–∑ 3:
[VISUAL-SCALE] stackHeight: 316.0px  ‚Üê ‚ö†Ô∏è –ï—â—ë –±–æ–ª—å—à–µ!
[VISUAL-SCALE] available: 200.0px  ‚Üê ‚ö†Ô∏è –ï—â—ë –º–µ–Ω—å—à–µ!
[VISUAL-SCALE] finalScale: 0.500  ‚Üê üìâ –°–∏–ª—å–Ω–æ–µ —Å–∂–∞—Ç–∏–µ!
[VISUAL-SCALE] visualLength: 110.0px  ‚Üê –ù–ê–ú–ù–û–ì–û –ö–û–†–û–ß–ï!
```

**–≠—Ç–æ –¥–æ–∫–∞–∂–µ—Ç —á—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ –≤ `stackHeight`!**

---

## üîß –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—Å—è, –Ω—É–∂–Ω–æ:

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ù–µ –≤—ã—á–∏—Ç–∞—Ç—å stackHeight
```javascript
// –ë–´–õ–û:
const available = canvas.height - anchorY - stackHeight - marginBottom;

// –î–û–õ–ñ–ù–û –ë–´–¢–¨:
const available = canvas.height - anchorY - marginBottom;
```

**–õ–æ–≥–∏–∫–∞:** –ì—Ä—É–∑—ã —Ä–∏—Å—É—é—Ç—Å—è –ø–æ–¥ –ø—Ä—É–∂–∏–Ω–æ–π –∏ –ù–ï –¥–æ–ª–∂–Ω—ã –≤–ª–∏—è—Ç—å –Ω–∞ —Ä–∞—Å—á—ë—Ç –º–∞—Å—à—Ç–∞–±–∞ –ø—Ä—É–∂–∏–Ω—ã!

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–µ–∑–µ—Ä–≤
```javascript
const fixedReserve = 200; // –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–µ–∑–µ—Ä–≤ –¥–ª—è –≥—Ä—É–∑–æ–≤
const available = canvas.height - anchorY - fixedReserve - marginBottom;
```

---

## üìù –í–∞–∂–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –ó–Ω–∞—á–µ–Ω–∏–µ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------------|----------|------------|
| `springNaturalLength` | 140px | –î–ª–∏–Ω–∞ –Ω–µ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–π –ø—Ä—É–∂–∏–Ω—ã |
| `elongationPx` | > 0 | –£–¥–ª–∏–Ω–µ–Ω–∏–µ –≤ –ø–∏–∫—Å–µ–ª—è—Ö (–î–û–õ–ñ–ù–û –±—ã—Ç—å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º!) |
| `targetLength` | natural + elongation | –¶–µ–ª–µ–≤–∞—è —Ñ–∏–∑–∏—á–µ—Å–∫–∞—è –¥–ª–∏–Ω–∞ |
| `stackHeight` | –†–∞—Å—Ç—ë—Ç —Å –≥—Ä—É–∑–∞–º–∏ | ‚ö†Ô∏è –í—ã—Å–æ—Ç–∞ —Å—Ç–æ–ø–∫–∏ –≥—Ä—É–∑–æ–≤ |
| `available` | –£–º–µ–Ω—å—à–∞–µ—Ç—Å—è! | ‚ö†Ô∏è –î–æ—Å—Ç—É–ø–Ω–æ–µ –º–µ—Å—Ç–æ –¥–ª—è –ø—Ä—É–∂–∏–Ω—ã |
| `visual.scale` | < 1 | –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Å–∂–∞—Ç–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è |
| `visualLength` | target √ó scale | –ò–¢–û–ì–û–í–ê–Ø –¥–ª–∏–Ω–∞ –Ω–∞ —ç–∫—Ä–∞–Ω–µ |

---

## ‚úÖ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚è≥ –ü–æ–ª—É—á–∏—Ç—å –ª–æ–≥–∏ —Å 1, 2, 3 –≥—Ä—É–∑–∞–º–∏
2. ‚è≥ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –≥–∏–ø–æ—Ç–µ–∑—É –æ stackHeight
3. ‚è≥ –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
4. ‚è≥ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç

---

**–°—Ç–∞—Ç—É—Å:** ‚è≥ –û–ñ–ò–î–ê–ù–ò–ï –î–ê–ù–ù–´–• –õ–û–ì–ò–†–û–í–ê–ù–ò–Ø
